[
 {
  elvis,
  [
   {config,
    [#{dirs => ["src"],
       filter => "**/*.erl",
       ruleset => erl_files,
       %% Generated sources (ASN.1 / yecc). Keeping them out of strict linting
       %% avoids noisy naming/style violations and churn in generated code.
       ignore => ['XmppAddr',
                  eldap_filter_yecc],
       rules => [{elvis_text_style, line_length, #{limit => 120,
                                                   skip_comments => false}},
                 {elvis_style, dont_repeat_yourself, disable},
                 {elvis_style, god_modules, disable},
                 {elvis_style, no_throw, disable},
                 {elvis_style, no_operation_on_same_value, disable},
                 %% Enabling recursion (`src/**`) exposes a large legacy backlog for some rules.
                 %% Disable the noisiest ones to keep Elvis useful and CI actionable.
                 {elvis_style, export_used_types, disable},
                 {elvis_style, operator_spaces, disable},
                 {elvis_style, max_function_arity, disable},
                 {elvis_style, no_if_expression, disable},
                 {elvis_style, no_space, disable},
                 {elvis_style, function_naming_convention, disable},
                 %% Prefer rule-based suppressions over file ignores for legacy areas.
                 %% These three tend to require broad refactors or risky renames.
                 {elvis_style, invalid_dynamic_call, disable},
                 {elvis_style, atom_naming_convention, disable},
                 {elvis_style, no_spec_with_records, disable},
                 {elvis_style, no_import, disable},
                 {elvis_style, no_author, disable},
                 {elvis_style, param_pattern_matching, disable},
                 {elvis_style, consistent_variable_casing, disable},
                 {elvis_style, no_catch_expressions, disable},
                 {elvis_style, no_receive_without_timeout, disable},
                 %% Disabled because pattern-matching on record-based types is common in the codebase
                 %% and making them opaque breaks Dialyzer when these types are pattern-matched
                 {elvis_style, private_data_types, disable}
                 ]
     },
     #{dirs => ["test", "test.disabled/mongoose_tests/tests"],
       filter => "**/*.erl",
       ruleset => erl_files,
       ignore => [auth_tokens_SUITE,
                  config_parser_SUITE,
                  ejabberd_sm_SUITE,
                  json_formatter_SUITE],
       rules => [{elvis_text_style, line_length, #{limit => 120,
                                                   skip_comments => false}},
                 {elvis_style, export_used_types, disable},
                 {elvis_style, invalid_dynamic_call, disable},
                 {elvis_style, no_debug_call, disable},
                 {elvis_style, no_spec_with_records, disable},
                 {elvis_style, dont_repeat_yourself, disable},
                 {elvis_style, god_modules, disable},
                 {elvis_style, no_throw, disable},
                 {elvis_style, no_operation_on_same_value, disable},
                 {elvis_style, no_author, disable},
                 {elvis_style, param_pattern_matching, disable},
                 {elvis_style, consistent_variable_casing, disable},
                 {elvis_style, no_catch_expressions, disable},
                 {elvis_style, operator_spaces, disable},
                 {elvis_style, no_import, disable},
                 {elvis_style, no_receive_without_timeout, disable},
                 {elvis_style, max_anonymous_function_arity, disable},
                 {elvis_style, no_boolean_in_comparison, disable},

                 %% Tests often contain camelCase atoms and helpers that don't match prod naming.
                 {elvis_style, atom_naming_convention, disable},
                 {elvis_style, function_naming_convention, disable},
                 {elvis_style, module_naming_convention, disable},

                 %% Keep tests flexible: avoid large refactors just for linting.
                 {elvis_style, no_block_expressions, disable},
                 {elvis_style, no_if_expression, disable},

                 %% Allow usage of macros like "?_assert_equal_extra".
                 {elvis_style, used_ignored_variable, disable},

                 %% Allow usage of ?assertMatch and similar macros, since after expanding they
                 %% result in use of variables like __X and __V that wouldn't be permitted by
                 %% default regex.
                 {elvis_style, variable_naming_convention, #{regex => "^(_?[A-Z][0-9a-zA-Z_]*)$"}},
                 {elvis_style, macro_names, disable}
                 ]
     }
    ]
   }
  ]
 }
].
